webpackJsonp([4],{"5PlU":function(e,t,a){var l=a("RY/4"),r=a("dSzd")("iterator"),n=a("/bQp");e.exports=a("FeBl").isIterable=function(e){var t=Object(e);return void 0!==t[r]||"@@iterator"in t||n.hasOwnProperty(l(t))}},FD6i:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("Dd8w"),r=a.n(l),n=a("d7EF"),i=a.n(n),s=a("W3Iv"),o=a.n(s),c=a("XLwt"),p={name:"CoreSample",data:function(){return{searchKeyword:"",dialogVisible:!1,dialogTitle:"添加样本",sampleForm:{id:"",location:"",depth:"",type:"",sampleDate:""},sampleList:[],currentPage:1,pageSize:5,chartInstance:null}},computed:{paginatedSamples:function(){var e=(this.currentPage-1)*this.pageSize;return this.sampleList.slice(e,e+this.pageSize)}},mounted:function(){this.chartInstance=c.init(this.$refs.chart),this.fetchSamples()},methods:{fetchSamples:function(){var e=this;this.$http.get("/core/list",{params:{keyword:this.searchKeyword}}).then(function(t){e.sampleList=t.data,e.updateChart()}).catch(function(t){e.$message.error("获取样本数据失败："+t)})},updateChart:function(){var e={};this.sampleList.forEach(function(t){e[t.type]=(e[t.type]||0)+1});var t=o()(e).map(function(e){var t=i()(e,2);return{name:t[0],value:t[1]}});this.chartInstance.setOption({title:{text:"样本类型分布",left:"center"},tooltip:{trigger:"item"},legend:{bottom:"10%",left:"center"},series:[{name:"类型分布",type:"pie",radius:"50%",data:t,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})},openAddDialog:function(){this.dialogTitle="添加样本",this.sampleForm={id:"",location:"",depth:"",type:"",date:""},this.dialogVisible=!0},editSample:function(e){this.dialogTitle="编辑样本",this.sampleForm=r()({},e),this.dialogVisible=!0},deleteSample:function(e){var t=this;this.$confirm("确定要删除该样本吗？","提示",{type:"warning"}).then(function(){t.$http.delete("/core/delete/"+e).then(function(){t.$message.success("删除成功"),t.fetchSamples()}).catch(function(){t.$message.error("删除失败")})})},saveSample:function(){var e=this;this.$http.post("/core/save",this.sampleForm).then(function(){e.$message.success("保存成功"),e.dialogVisible=!1,e.fetchSamples()}).catch(function(){e.$message.error("保存失败")})},handlePageChange:function(e){this.currentPage=e}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"core-sample-container"},[a("div",{staticClass:"top-bar"},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"输入样本编号或采集地点",size:"medium",clearable:""},on:{input:e.fetchSamples},scopedSlots:e._u([{key:"prefix",fn:function(){return[a("span",{staticClass:"icon-wrapper"},[a("i",{staticClass:"el-icon-search"})])]},proxy:!0}]),model:{value:e.searchKeyword,callback:function(t){e.searchKeyword=t},expression:"searchKeyword"}}),e._v(" "),a("el-button",{attrs:{type:"success",icon:"el-icon-plus",size:"medium"},on:{click:e.openAddDialog}},[e._v("添加样本")])],1),e._v(" "),a("div",{ref:"chart",staticClass:"chart-container"}),e._v(" "),a("el-table",{staticClass:"core-table",attrs:{data:e.paginatedSamples,stripe:"",border:"","header-cell-class-name":"table-header"}},[a("el-table-column",{attrs:{prop:"id",label:"样本编号",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"location",label:"采集地点"}}),e._v(" "),a("el-table-column",{attrs:{prop:"depth",label:"深度/m",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"样本类型",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sampleDate",label:"采集日期",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.editSample(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.deleteSample(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-pagination",{staticStyle:{"text-align":"right","margin-top":"15px"},attrs:{background:"",layout:"prev, pager, next","page-size":5,total:e.sampleList.length},on:{"current-change":e.handlePageChange}}),e._v(" "),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"500px"},on:{"update:visible":function(t){e.dialogVisible=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.saveSample}},[e._v("保存")])]},proxy:!0}])},[a("el-form",{attrs:{model:e.sampleForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"样本编号"}},[a("el-input",{model:{value:e.sampleForm.id,callback:function(t){e.$set(e.sampleForm,"id",t)},expression:"sampleForm.id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"采集地点"}},[a("el-input",{model:{value:e.sampleForm.location,callback:function(t){e.$set(e.sampleForm,"location",t)},expression:"sampleForm.location"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"深度（米）"}},[a("el-input",{attrs:{type:"number"},model:{value:e.sampleForm.depth,callback:function(t){e.$set(e.sampleForm,"depth",t)},expression:"sampleForm.depth"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"样本类型"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.sampleForm.type,callback:function(t){e.$set(e.sampleForm,"type",t)},expression:"sampleForm.type"}},[a("el-option",{attrs:{label:"岩石",value:"岩石"}}),e._v(" "),a("el-option",{attrs:{label:"矿物",value:"矿物"}}),e._v(" "),a("el-option",{attrs:{label:"土壤",value:"土壤"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"采集日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.sampleForm.sampleDate,callback:function(t){e.$set(e.sampleForm,"sampleDate",t)},expression:"sampleForm.sampleDate"}})],1)],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(p,u,!1,function(e){a("OIfs")},"data-v-12544ec8",null);t.default=d.exports},OIfs:function(e,t){},W3Iv:function(e,t,a){e.exports={default:a("wEtr"),__esModule:!0}},Xd32:function(e,t,a){a("+tPU"),a("zQR9"),e.exports=a("5PlU")},d7EF:function(e,t,a){"use strict";t.__esModule=!0;var l=n(a("us/S")),r=n(a("BO1k"));function n(e){return e&&e.__esModule?e:{default:e}}t.default=function(){return function(e,t){if(Array.isArray(e))return e;if((0,l.default)(Object(e)))return function(e,t){var a=[],l=!0,n=!1,i=void 0;try{for(var s,o=(0,r.default)(e);!(l=(s=o.next()).done)&&(a.push(s.value),!t||a.length!==t);l=!0);}catch(e){n=!0,i=e}finally{try{!l&&o.return&&o.return()}finally{if(n)throw i}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},gSvA:function(e,t,a){var l=a("kM2E"),r=a("mbce")(!0);l(l.S,"Object",{entries:function(e){return r(e)}})},mbce:function(e,t,a){var l=a("+E39"),r=a("lktj"),n=a("TcQ7"),i=a("NpIQ").f;e.exports=function(e){return function(t){for(var a,s=n(t),o=r(s),c=o.length,p=0,u=[];c>p;)a=o[p++],l&&!i.call(s,a)||u.push(e?[a,s[a]]:s[a]);return u}}},"us/S":function(e,t,a){e.exports={default:a("Xd32"),__esModule:!0}},wEtr:function(e,t,a){a("gSvA"),e.exports=a("FeBl").Object.entries}});
//# sourceMappingURL=4.a44f52f707895e1506e6.js.map