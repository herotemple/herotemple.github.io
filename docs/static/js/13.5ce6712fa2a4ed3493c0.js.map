{"version":3,"sources":["webpack:///src/components/page/reportview.vue","webpack:///./src/components/page/reportview.vue?9287","webpack:///./src/components/page/reportview.vue"],"names":["reportview","data","loading","rawData","chartData","chartInstance","selectedYear","mounted","this","loadReport","methods","year","_this","params","undefined","parseInt","$http","get","then","res","console","log","body","Array","isArray","processData","$nextTick","renderChart","alert","catch","err","error","_this2","types","concat","toConsumableArray_default","set_default","a","map","item","type","months","from_default","length","_","i","series","name","stack","emphasis","focus","m","match","find","d","month","count","stringify_default","chartDom","$refs","echarts","dispose","option","tooltip","trigger","axisPointer","legend","top","grid","left","right","bottom","containLabel","xAxis","yAxis","setOption","warn","beforeDestroy","page_reportview","render","_vm","_h","$createElement","_c","_self","staticClass","staticStyle","padding","max-width","margin","_v","margin-bottom","margin-right","on","click","$event","_l","y","key","_s","text-align","font-size","color","_e","ref","height","width","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/13.5ce6712fa2a4ed3493c0.js","sourcesContent":["<template>\n  <div class=\"report-page\" style=\"padding: 20px; max-width: 1000px; margin: auto;\">\n    <h2>岩芯样本月度统计报表（全部年份）</h2>\n\n    <div style=\"margin-bottom: 20px;\">\n      <button @click=\"loadReport(null)\" style=\"padding: 6px 12px; margin-right: 10px;\">全部年份</button>\n      <button v-for=\"y in [2022, 2023, 2024]\" :key=\"y\" @click=\"loadReport(y)\" style=\"padding: 6px 12px; margin-right: 5px;\">\n        {{ y }}\n      </button>\n    </div>\n\n    <div v-if=\"loading\" style=\"text-align:center; font-size:16px; color:#888;\">加载中...</div>\n    <div v-else>\n      <div v-if=\"!chartData || chartData.length === 0\" style=\"text-align:center; color:#888;\">暂无数据</div>\n      <div ref=\"echarts\" style=\"height: 400px; width: 100%;\"></div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport * as echarts from 'echarts';\n\nexport default {\n  data() {\n    return {\n      loading: false,\n      rawData: [],\n      chartData: [],\n      chartInstance: null,\n      selectedYear: null,\n    };\n  },\n  mounted() {\n    this.loadReport(null); // 默认加载全部年份数据\n  },\n  methods: {\n    loadReport(year) {\n      this.loading = true;\n      const params = {};\n      if (year !== null && year !== undefined) {\n        params.year = parseInt(year, 10);\n      }\n      this.$http.get('/core/monthly', {params})\n        .then(res => {\n          this.loading = false;\n          console.log('接口返回 res =', res);\n          const data = res.data || res.body || [];\n          if (Array.isArray(data)) {\n            this.rawData = data;\n            this.processData();\n            this.$nextTick(() => {\n              this.renderChart();\n            });\n          } else {\n            alert('获取数据失败');\n          }\n        })\n        .catch(err => {\n          this.loading = false;\n          console.error('请求出错:', err);\n          alert('请求出错');\n        });\n    },\n    processData() {\n      const types = [...new Set(this.rawData.map(item => item.type))];\n      const months = Array.from({ length: 12 }, (_, i) => i + 1);\n\n      const series = types.map(type => {\n        return {\n          name: type,\n          type: 'bar',\n          stack: 'total',\n          emphasis: { focus: 'series' },\n          data: months.map(m => {\n            const match = this.rawData.find(d => parseInt(d.month) === m && d.type === type);\n            return match ? match.count : 0;\n          })\n        };\n      });\n\n      // ✅ 打印调试确认数据结构\n      console.log('months:', months);\n      console.log('types:', types);\n      console.log('series:', JSON.stringify(series, null, 2));\n\n      this.chartData = {\n        months,\n        types,\n        series\n      };\n    },\n    renderChart() {\n      const chartDom = this.$refs.echarts;\n      if (!chartDom) {\n        console.warn('echarts 容器未找到');\n        return;\n      }\n\n      // 清除旧图表实例\n      if (this.chartInstance) {\n        this.chartInstance.dispose();\n      }\n      this.chartInstance = echarts.init(chartDom);\n\n      // 若无数据则不渲染\n      if (!this.chartData || !this.chartData.series || this.chartData.series.length === 0) {\n        console.warn('series 数据为空，图表不渲染');\n        return;\n      }\n\n      const option = {\n        tooltip: {\n          trigger: 'axis',\n          axisPointer: { type: 'shadow' }\n        },\n        legend: {\n          data: this.chartData.types,\n          top: 'bottom'\n        },\n        grid: {\n          left: '3%',\n          right: '4%',\n          bottom: '12%',\n          containLabel: true\n        },\n        xAxis: {\n          type: 'category',\n          data: this.chartData.months.map(m => `${m}月`)\n        },\n        yAxis: {\n          type: 'value'\n        },\n        series: this.chartData.series\n      };\n\n      this.chartInstance.setOption(option);\n    }\n  },\n  beforeDestroy() {\n    if (this.chartInstance) {\n      this.chartInstance.dispose();\n      this.chartInstance = null;\n    }\n  }\n};\n</script>\n\n<style scoped>\nbutton {\n  background-color: #409EFF;\n  border: none;\n  color: white;\n  cursor: pointer;\n  border-radius: 4px;\n}\n\nbutton:hover {\n  background-color: #66b1ff;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/page/reportview.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"report-page\",staticStyle:{\"padding\":\"20px\",\"max-width\":\"1000px\",\"margin\":\"auto\"}},[_c('h2',[_vm._v(\"岩芯样本月度统计报表（全部年份）\")]),_vm._v(\" \"),_c('div',{staticStyle:{\"margin-bottom\":\"20px\"}},[_c('button',{staticStyle:{\"padding\":\"6px 12px\",\"margin-right\":\"10px\"},on:{\"click\":function($event){return _vm.loadReport(null)}}},[_vm._v(\"全部年份\")]),_vm._v(\" \"),_vm._l(([2022, 2023, 2024]),function(y){return _c('button',{key:y,staticStyle:{\"padding\":\"6px 12px\",\"margin-right\":\"5px\"},on:{\"click\":function($event){return _vm.loadReport(y)}}},[_vm._v(\"\\n      \"+_vm._s(y)+\"\\n    \")])})],2),_vm._v(\" \"),(_vm.loading)?_c('div',{staticStyle:{\"text-align\":\"center\",\"font-size\":\"16px\",\"color\":\"#888\"}},[_vm._v(\"加载中...\")]):_c('div',[(!_vm.chartData || _vm.chartData.length === 0)?_c('div',{staticStyle:{\"text-align\":\"center\",\"color\":\"#888\"}},[_vm._v(\"暂无数据\")]):_vm._e(),_vm._v(\" \"),_c('div',{ref:\"echarts\",staticStyle:{\"height\":\"400px\",\"width\":\"100%\"}})])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-6fbeda00\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/page/reportview.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6fbeda00\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./reportview.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./reportview.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./reportview.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6fbeda00\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./reportview.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-6fbeda00\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/page/reportview.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}